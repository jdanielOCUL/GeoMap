<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OGR: OGR API Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>OGR API Tutorial </h1>  </div>
</div>
<div class="contents">
<p>This document is intended to document using the OGR C++ classes to read and write data from a file. It is strongly advised that the read first review the <a href="ogr_arch.html">OGR Architecture</a> document describing the key classes and their roles in OGR.</p>
<p>It also includes code snippets for the corresponding functions in C and Python.</p>
<h2><a class="anchor" id="ogr_apitut_read"></a>
Reading From OGR</h2>
<p>For purposes of demonstrating reading with OGR, we will construct a small utility for dumping point layers from an OGR data source to stdout in comma-delimited format.</p>
<p>Initially it is necessary to register all the format drivers that are desired. This is normally accomplished by calling <a class="el" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll()</a> which registers all format drivers built into GDAL/OGR.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span>

<span class="keywordtype">int</span> main()

{
        <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogr__api_8h.html">ogr_api.h</a>&quot;</span>

<span class="keywordtype">int</span> main()

{
        <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();
</pre></div><p>Next we need to open the input OGR datasource. Datasources can be files, RDBMSes, directories full of files, or even remote web services depending on the driver being used. However, the datasource name is always a single string. In this case we are hardcoded to open a particular shapefile. The second argument (FALSE) tells the <a class="el" href="classOGRSFDriverRegistrar.html#a5ee13e09d55d146f45bb5417fa524f54" title="Open a file / data source with one of the registered drivers.">OGRSFDriverRegistrar::Open()</a> method that we don't require update access. On failure NULL is returned, and we report an error.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRDataSource.html">OGRDataSource</a>       *poDS;

    poDS = <a class="code" href="classOGRSFDriverRegistrar.html#a5ee13e09d55d146f45bb5417fa524f54" title="Open a file / data source with one of the registered drivers.">OGRSFDriverRegistrar::Open</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, FALSE );
    <span class="keywordflow">if</span>( poDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRDataSourceH hDS;

    hDS = <a class="code" href="ogr__api_8h.html#a2da3630231780d519543d1679c83e62f" title="Open a file / data source with one of the registered drivers.">OGROpen</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, FALSE, NULL );
    <span class="keywordflow">if</span>( hDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>An <a class="el" href="classOGRDataSource.html">OGRDataSource</a> can potentially have many layers associated with it. The number of layers available can be queried with <a class="el" href="classOGRDataSource.html#a031694429394662fd50353c5e2b68692" title="Get the number of layers in this data source.">OGRDataSource::GetLayerCount()</a> and individual layers fetched by index using <a class="el" href="classOGRDataSource.html#a618c2fdb1067c9357ca2de9fa6cd5962" title="Fetch a layer by index.">OGRDataSource::GetLayer()</a>. However, we will just fetch the layer by name.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRLayer.html">OGRLayer</a>  *poLayer;

    poLayer = poDS-&gt;<a class="code" href="classOGRDataSource.html#aa0fafafc83084ad140ecdf17d9e139f9" title="Fetch a layer by name.">GetLayerByName</a>( <span class="stringliteral">&quot;point&quot;</span> );
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRLayerH hLayer;

    hLayer = <a class="code" href="ogr__api_8h.html#a74af4912b67bf2a7b6e3230711a40d0e" title="Fetch a layer by name.">OGR_DS_GetLayerByName</a>( hDS, <span class="stringliteral">&quot;point&quot;</span> );
</pre></div><p>Now we want to start reading features from the layer. Before we start we could assign an attribute or spatial filter to the layer to restrict the set of feature we get back, but for now we are interested in getting all features.</p>
<p>While it isn't strictly necessary in this circumstance since we are starting fresh with the layer, it is often wise to call <a class="el" href="classOGRLayer.html#aad0f2cd7f0587584b8f382c6a913583c" title="Reset feature reading to start on the first feature.">OGRLayer::ResetReading()</a> to ensure we are starting at the beginning of the layer. We iterate through all the features in the layer using <a class="el" href="classOGRLayer.html#a47d21ff33b32d14fa4e9885b9edecad6" title="Fetch the next available feature from this layer.">OGRLayer::GetNextFeature()</a>. It will return NULL when we run out of features.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;

    poLayer-&gt;<a class="code" href="classOGRLayer.html#aad0f2cd7f0587584b8f382c6a913583c" title="Reset feature reading to start on the first feature.">ResetReading</a>();
    <span class="keywordflow">while</span>( (poFeature = poLayer-&gt;<a class="code" href="classOGRLayer.html#a47d21ff33b32d14fa4e9885b9edecad6" title="Fetch the next available feature from this layer.">GetNextFeature</a>()) != NULL )
    {
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRFeatureH hFeature;

    <a class="code" href="ogr__api_8h.html#ab0383004bf637171648a9d03a80f15a4" title="Reset feature reading to start on the first feature.">OGR_L_ResetReading</a>(hLayer);
    <span class="keywordflow">while</span>( (hFeature = <a class="code" href="ogr__api_8h.html#a6708c067521ab7b7f9c4ec0ebe221b5b" title="Fetch the next available feature from this layer.">OGR_L_GetNextFeature</a>(hLayer)) != NULL )
    {
</pre></div><p>In order to dump all the attribute fields of the feature, it is helpful to get the <a class="el" href="classOGRFeatureDefn.html">OGRFeatureDefn</a>. This is an object, associated with the layer, containing the definitions of all the fields. We loop over all the fields, and fetch and report the attributes based on their type.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> *poFDefn = poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf" title="Fetch the schema information for this layer.">GetLayerDefn</a>();
        <span class="keywordtype">int</span> iField;

        <span class="keywordflow">for</span>( iField = 0; iField &lt; poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#ab400f9106e7544ebafa30b1fe59869b1" title="Fetch number of fields on this feature.">GetFieldCount</a>(); iField++ )
        {
            <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> *poFieldDefn = poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a43b95ce699bbca73acb453cc959378e7" title="Fetch field definition.">GetFieldDefn</a>( iField );

            <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTInteger )
                printf( <span class="stringliteral">&quot;%d,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#add319b68ea27a4ee0602d3aa460ca3b5" title="Fetch field value as integer.">GetFieldAsInteger</a>( iField ) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTReal )
                printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ab8a57c94e8bb8ffac5e7048d896254b4" title="Fetch field value as a double.">GetFieldAsDouble</a>(iField) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTString )
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">GetFieldAsString</a>(iField) );
            <span class="keywordflow">else</span>
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">GetFieldAsString</a>(iField) );
        }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        OGRFeatureDefnH hFDefn = <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d" title="Fetch the schema information for this layer.">OGR_L_GetLayerDefn</a>(hLayer);
        <span class="keywordtype">int</span> iField;

        <span class="keywordflow">for</span>( iField = 0; iField &lt; <a class="code" href="ogr__api_8h.html#a586a14271a457387a2b5c0097a02c8da" title="Fetch number of fields on the passed feature definition.">OGR_FD_GetFieldCount</a>(hFDefn); iField++ )
        {
            OGRFieldDefnH hFieldDefn = <a class="code" href="ogr__api_8h.html#a484456df86a01284769d0afe3beaa4f6" title="Fetch field definition of the passed feature definition.">OGR_FD_GetFieldDefn</a>( hFDefn, iField );

            <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a> )
                printf( <span class="stringliteral">&quot;%d,&quot;</span>, <a class="code" href="ogr__api_8h.html#acfb4d2c0001af379e396021ecbdaf275" title="Fetch field value as integer.">OGR_F_GetFieldAsInteger</a>( hFeature, iField ) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a> )
                printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, <a class="code" href="ogr__api_8h.html#a62252a0d4538c695d41956a96cdc6978" title="Fetch field value as a double.">OGR_F_GetFieldAsDouble</a>( hFeature, iField) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> )
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26" title="Fetch field value as a string.">OGR_F_GetFieldAsString</a>( hFeature, iField) );
            <span class="keywordflow">else</span>
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26" title="Fetch field value as a string.">OGR_F_GetFieldAsString</a>( hFeature, iField) );
        }
</pre></div><p>There are a few more field types than those explicitly handled above, but a reasonable representation of them can be fetched with the <a class="el" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">OGRFeature::GetFieldAsString()</a> method. In fact we could shorten the above by using <a class="el" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">OGRFeature::GetFieldAsString()</a> for all the types.</p>
<p>Next we want to extract the geometry from the feature, and write out the point geometry x and y. Geometries are returned as a generic <a class="el" href="classOGRGeometry.html">OGRGeometry</a> pointer. We then determine the specific geometry type, and if it is a point, we cast it to point and operate on it. If it is something else we write placeholders.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;

        poGeometry = poFeature-&gt;<a class="code" href="classOGRFeature.html#acc966ce8c10ae3ddf9f14c2736fdce9a" title="Fetch pointer to feature geometry.">GetGeometryRef</a>();
        <span class="keywordflow">if</span>( poGeometry != NULL 
            &amp;&amp; wkbFlatten(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5" title="Fetch geometry type.">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;

            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68" title="Fetch X coordinate.">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9" title="Fetch Y coordinate.">getY</a>() );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }       
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        OGRGeometryH hGeometry;

        hGeometry = <a class="code" href="ogr__api_8h.html#a1bf9596756aeacec4da502383c378f5c" title="Fetch an handle to feature geometry.">OGR_F_GetGeometryRef</a>(hFeature);
        <span class="keywordflow">if</span>( hGeometry != NULL 
            &amp;&amp; wkbFlatten(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76" title="Fetch geometry type.">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, OGR_G_GetX(hGeometry, 0), OGR_G_GetY(hGeometry, 0) );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }       
</pre></div><p>The wkbFlatten() macro is used above to convert the type for a wkbPoint25D (a point with a z coordinate) into the base 2D geometry type code (wkbPoint). For each 2D geometry type there is a corresponding 2.5D type code. The 2D and 2.5D geometry cases are handled by the same C++ class, so our code will handle 2D or 3D cases properly.</p>
<p>Starting with OGR 1.11, <a href="http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields">several geometry fields</a> can be associated to a feature.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;
    <span class="keywordtype">int</span> iGeomField;
    <span class="keywordtype">int</span> nGeomFieldCount;

    nGeomFieldCount = poFeature-&gt;<a class="code" href="classOGRFeature.html#af673e46f318facbee14acec3d6db2caf" title="Fetch number of geometry fields on this feature. This will always be the same as the geometry field c...">GetGeomFieldCount</a>();
    <span class="keywordflow">for</span>(iGeomField = 0; iGeomField &lt; nGeomFieldCount; iGeomField ++ )
    {
        poGeometry = poFeature-&gt;<a class="code" href="classOGRFeature.html#ae54d999d4649730d5c7b37de731e4f69" title="Fetch pointer to feature geometry.">GetGeomFieldRef</a>(iGeomField);
        <span class="keywordflow">if</span>( poGeometry != NULL 
                &amp;&amp; wkbFlatten(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5" title="Fetch geometry type.">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;

            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68" title="Fetch X coordinate.">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9" title="Fetch Y coordinate.">getY</a>() );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRGeometryH hGeometry;
    <span class="keywordtype">int</span> iGeomField;
    <span class="keywordtype">int</span> nGeomFieldCount;

    nGeomFieldCount = <a class="code" href="ogr__api_8h.html#a7975076d4ab247189487c0fd50d8365c" title="Fetch number of geometry fields on this feature This will always be the same as the geometry field co...">OGR_F_GetGeomFieldCount</a>(hFeature);
    <span class="keywordflow">for</span>(iGeomField = 0; iGeomField &lt; nGeomFieldCount; iGeomField ++ )
    {
        hGeometry = <a class="code" href="ogr__api_8h.html#a37aa8b53b1fc8816c5b7bcbbcb6a46ca" title="Fetch an handle to feature geometry.">OGR_F_GetGeomFieldRef</a>(hFeature, iGeomField);
        <span class="keywordflow">if</span>( hGeometry != NULL 
                &amp;&amp; wkbFlatten(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76" title="Fetch geometry type.">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, OGR_G_GetX(hGeometry, 0),
                    OGR_G_GetY(hGeometry, 0) );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }
    }
</pre></div><p>In Python: </p>
<div class="fragment"><pre class="fragment">    nGeomFieldCount = feat.GetGeomFieldCount()
    <span class="keywordflow">for</span> iGeomField in range(nGeomFieldCount):
        geom = feat.GetGeomFieldRef(iGeomField)
        if geom is not None and geom.GetGeometryType() == ogr.<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>:
            print <span class="stringliteral">&quot;%.3f, %.3f&quot;</span> % ( geom.GetX(), geom.GetY() )
        else:
            print <span class="stringliteral">&quot;no point geometry\n&quot;</span>
</pre></div><p>Note that <a class="el" href="classOGRFeature.html#acc966ce8c10ae3ddf9f14c2736fdce9a" title="Fetch pointer to feature geometry.">OGRFeature::GetGeometryRef()</a> and <a class="el" href="classOGRFeature.html#ae54d999d4649730d5c7b37de731e4f69" title="Fetch pointer to feature geometry.">OGRFeature::GetGeomFieldRef()</a> return a pointer to the internal geometry owned by the <a class="el" href="classOGRFeature.html">OGRFeature</a>. There we don't actually deleted the return geometry. However, the <a class="el" href="classOGRLayer.html#a47d21ff33b32d14fa4e9885b9edecad6" title="Fetch the next available feature from this layer.">OGRLayer::GetNextFeature()</a> method returns a copy of the feature that is now owned by us. So at the end of use we must free the feature. We could just "delete" it, but this can cause problems in windows builds where the GDAL DLL has a different "heap" from the main program. To be on the safe side we use a GDAL function to delete the feature.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45" title="Destroy feature.">OGRFeature::DestroyFeature</a>( poFeature );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb" title="Destroy feature.">OGR_F_Destroy</a>( hFeature );
    }
</pre></div><p>The <a class="el" href="classOGRLayer.html">OGRLayer</a> returned by <a class="el" href="classOGRDataSource.html#aa0fafafc83084ad140ecdf17d9e139f9" title="Fetch a layer by name.">OGRDataSource::GetLayerByName()</a> is also a reference to an internal layer owned by the <a class="el" href="classOGRDataSource.html">OGRDataSource</a> so we don't need to delete it. But we do need to delete the datasource in order to close the input file. Once again we do this with a custom delete method to avoid special win32 heap issus.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRDataSource.html#a77841576d07b24a01208e4125ccb40a5" title="Closes opened datasource and releases allocated resources.">OGRDataSource::DestroyDataSource</a>( poDS );
}
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="ogr__api_8h.html#a4823e7c3513cd9d57254364de9a1d021" title="Closes opened datasource and releases allocated resources.">OGR_DS_Destroy</a>( hDS );
}
</pre></div><p>All together our program looks like this.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span>

<span class="keywordtype">int</span> main()

{
    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    <a class="code" href="classOGRDataSource.html">OGRDataSource</a>       *poDS;

    poDS = <a class="code" href="classOGRSFDriverRegistrar.html#a5ee13e09d55d146f45bb5417fa524f54" title="Open a file / data source with one of the registered drivers.">OGRSFDriverRegistrar::Open</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, FALSE );
    <span class="keywordflow">if</span>( poDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );
        exit( 1 );
    }

    <a class="code" href="classOGRLayer.html">OGRLayer</a>  *poLayer;

    poLayer = poDS-&gt;<a class="code" href="classOGRDataSource.html#aa0fafafc83084ad140ecdf17d9e139f9" title="Fetch a layer by name.">GetLayerByName</a>( <span class="stringliteral">&quot;point&quot;</span> );

    <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;

    poLayer-&gt;<a class="code" href="classOGRLayer.html#aad0f2cd7f0587584b8f382c6a913583c" title="Reset feature reading to start on the first feature.">ResetReading</a>();
    <span class="keywordflow">while</span>( (poFeature = poLayer-&gt;<a class="code" href="classOGRLayer.html#a47d21ff33b32d14fa4e9885b9edecad6" title="Fetch the next available feature from this layer.">GetNextFeature</a>()) != NULL )
    {
        <a class="code" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> *poFDefn = poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf" title="Fetch the schema information for this layer.">GetLayerDefn</a>();
        <span class="keywordtype">int</span> iField;

        <span class="keywordflow">for</span>( iField = 0; iField &lt; poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#ab400f9106e7544ebafa30b1fe59869b1" title="Fetch number of fields on this feature.">GetFieldCount</a>(); iField++ )
        {
            <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> *poFieldDefn = poFDefn-&gt;<a class="code" href="classOGRFeatureDefn.html#a43b95ce699bbca73acb453cc959378e7" title="Fetch field definition.">GetFieldDefn</a>( iField );

            <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTInteger )
                printf( <span class="stringliteral">&quot;%d,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#add319b68ea27a4ee0602d3aa460ca3b5" title="Fetch field value as integer.">GetFieldAsInteger</a>( iField ) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTReal )
                printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ab8a57c94e8bb8ffac5e7048d896254b4" title="Fetch field value as a double.">GetFieldAsDouble</a>(iField) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( poFieldDefn-&gt;<a class="code" href="classOGRFieldDefn.html#ac59789eed0b750d05f8ce8b6a8c68dfb" title="Fetch type of this field.">GetType</a>() == OFTString )
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">GetFieldAsString</a>(iField) );
            <span class="keywordflow">else</span>
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, poFeature-&gt;<a class="code" href="classOGRFeature.html#ac7a0224e13dce1f9479a6bf2111ea766" title="Fetch field value as a string.">GetFieldAsString</a>(iField) );
        }

        <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;

        poGeometry = poFeature-&gt;<a class="code" href="classOGRFeature.html#acc966ce8c10ae3ddf9f14c2736fdce9a" title="Fetch pointer to feature geometry.">GetGeometryRef</a>();
        <span class="keywordflow">if</span>( poGeometry != NULL 
            &amp;&amp; wkbFlatten(poGeometry-&gt;<a class="code" href="classOGRGeometry.html#a5c6bca18682cb933e3227552d480e1a5" title="Fetch geometry type.">getGeometryType</a>()) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            <a class="code" href="classOGRPoint.html">OGRPoint</a> *poPoint = (<a class="code" href="classOGRPoint.html">OGRPoint</a> *) poGeometry;

            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, poPoint-&gt;<a class="code" href="classOGRPoint.html#a1d7f8cb579cd0d029efda38026bf4b68" title="Fetch X coordinate.">getX</a>(), poPoint-&gt;<a class="code" href="classOGRPoint.html#a235eac8e50f6ce105ff5c16655d05ba9" title="Fetch Y coordinate.">getY</a>() );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }       
        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45" title="Destroy feature.">OGRFeature::DestroyFeature</a>( poFeature );
    }

    <a class="code" href="classOGRDataSource.html#a77841576d07b24a01208e4125ccb40a5" title="Closes opened datasource and releases allocated resources.">OGRDataSource::DestroyDataSource</a>( poDS );
}
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogr__api_8h.html">ogr_api.h</a>&quot;</span>

<span class="keywordtype">int</span> main()

{
    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    OGRDataSourceH hDS;
    OGRLayerH hLayer;
    OGRFeatureH hFeature;

    hDS = <a class="code" href="ogr__api_8h.html#a2da3630231780d519543d1679c83e62f" title="Open a file / data source with one of the registered drivers.">OGROpen</a>( <span class="stringliteral">&quot;point.shp&quot;</span>, FALSE, NULL );
    <span class="keywordflow">if</span>( hDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Open failed.\n&quot;</span> );
        exit( 1 );
    }

    hLayer = <a class="code" href="ogr__api_8h.html#a74af4912b67bf2a7b6e3230711a40d0e" title="Fetch a layer by name.">OGR_DS_GetLayerByName</a>( hDS, <span class="stringliteral">&quot;point&quot;</span> );

    <a class="code" href="ogr__api_8h.html#ab0383004bf637171648a9d03a80f15a4" title="Reset feature reading to start on the first feature.">OGR_L_ResetReading</a>(hLayer);
    <span class="keywordflow">while</span>( (hFeature = <a class="code" href="ogr__api_8h.html#a6708c067521ab7b7f9c4ec0ebe221b5b" title="Fetch the next available feature from this layer.">OGR_L_GetNextFeature</a>(hLayer)) != NULL )
    {
        OGRFeatureDefnH hFDefn;
        <span class="keywordtype">int</span> iField;
        OGRGeometryH hGeometry;

        hFDefn = <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d" title="Fetch the schema information for this layer.">OGR_L_GetLayerDefn</a>(hLayer);

        <span class="keywordflow">for</span>( iField = 0; iField &lt; <a class="code" href="ogr__api_8h.html#a586a14271a457387a2b5c0097a02c8da" title="Fetch number of fields on the passed feature definition.">OGR_FD_GetFieldCount</a>(hFDefn); iField++ )
        {
            OGRFieldDefnH hFieldDefn = <a class="code" href="ogr__api_8h.html#a484456df86a01284769d0afe3beaa4f6" title="Fetch field definition of the passed feature definition.">OGR_FD_GetFieldDefn</a>( hFDefn, iField );

            <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca81294535b47252b1da0274f178420ae4">OFTInteger</a> )
                printf( <span class="stringliteral">&quot;%d,&quot;</span>, <a class="code" href="ogr__api_8h.html#acfb4d2c0001af379e396021ecbdaf275" title="Fetch field value as integer.">OGR_F_GetFieldAsInteger</a>( hFeature, iField ) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca99520e47d9e26303f7c0127c1254c962">OFTReal</a> )
                printf( <span class="stringliteral">&quot;%.3f,&quot;</span>, <a class="code" href="ogr__api_8h.html#a62252a0d4538c695d41956a96cdc6978" title="Fetch field value as a double.">OGR_F_GetFieldAsDouble</a>( hFeature, iField) );
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#ad8d150dfc678e0a2a7f5241ba38c5611" title="Fetch type of this field.">OGR_Fld_GetType</a>(hFieldDefn) == <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> )
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26" title="Fetch field value as a string.">OGR_F_GetFieldAsString</a>( hFeature, iField) );
            <span class="keywordflow">else</span>
                printf( <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="ogr__api_8h.html#a42acfd1f4b49dddc1c308462ae800c26" title="Fetch field value as a string.">OGR_F_GetFieldAsString</a>( hFeature, iField) );
        }

        hGeometry = <a class="code" href="ogr__api_8h.html#a1bf9596756aeacec4da502383c378f5c" title="Fetch an handle to feature geometry.">OGR_F_GetGeometryRef</a>(hFeature);
        <span class="keywordflow">if</span>( hGeometry != NULL 
            &amp;&amp; wkbFlatten(<a class="code" href="ogr__api_8h.html#a8fae58102f5c4a4cf2526e5ca8369a76" title="Fetch geometry type.">OGR_G_GetGeometryType</a>(hGeometry)) == <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> )
        {
            printf( <span class="stringliteral">&quot;%.3f,%3.f\n&quot;</span>, OGR_G_GetX(hGeometry, 0), OGR_G_GetY(hGeometry, 0) );
        }
        <span class="keywordflow">else</span>
        {
            printf( <span class="stringliteral">&quot;no point geometry\n&quot;</span> );
        }

        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb" title="Destroy feature.">OGR_F_Destroy</a>( hFeature );
    }

    <a class="code" href="ogr__api_8h.html#a4823e7c3513cd9d57254364de9a1d021" title="Closes opened datasource and releases allocated resources.">OGR_DS_Destroy</a>( hDS );
}
</pre></div><p>In Python: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">import</span> sys
<span class="keyword">import</span> ogr

ds = ogr.Open( <span class="stringliteral">&quot;point.shp&quot;</span> )
<span class="keywordflow">if</span> ds is None:
    print <span class="stringliteral">&quot;Open failed.\n&quot;</span>
    sys.exit( 1 )

lyr = ds.GetLayerByName( <span class="stringliteral">&quot;point&quot;</span> )

lyr.ResetReading()

<span class="keywordflow">for</span> feat in lyr:

    feat_defn = lyr.GetLayerDefn()
    <span class="keywordflow">for</span> i in range(feat_defn.GetFieldCount()):
        field_defn = feat_defn.GetFieldDefn(i)

<span class="preprocessor">        # Tests below can be simplified with just :</span>
<span class="preprocessor"></span><span class="preprocessor">        # print feat.GetField(i)</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> field_defn.GetType() == ogr.OFTInteger:
            print <span class="stringliteral">&quot;%d&quot;</span> % feat.GetFieldAsInteger(i)
        elif field_defn.GetType() == ogr.OFTReal:
            print <span class="stringliteral">&quot;%.3f&quot;</span> % feat.GetFieldAsDouble(i)
        elif field_defn.GetType() == ogr.OFTString:
            print <span class="stringliteral">&quot;%s&quot;</span> % feat.GetFieldAsString(i)
        <span class="keywordflow">else</span>:
            print <span class="stringliteral">&quot;%s&quot;</span> % feat.GetFieldAsString(i)

    geom = feat.GetGeometryRef()
    <span class="keywordflow">if</span> geom is not None and geom.GetGeometryType() == ogr.wkbPoint:
        print <span class="stringliteral">&quot;%.3f, %.3f&quot;</span> % ( geom.GetX(), geom.GetY() )
    <span class="keywordflow">else</span>:
        print <span class="stringliteral">&quot;no point geometry\n&quot;</span>

ds = None
</pre></div><h2><a class="anchor" id="ogr_apitut_write"></a>
Writing To OGR</h2>
<p>As an example of writing through OGR, we will do roughly the opposite of the above. A short program that reads comma separated values from input text will be written to a point shapefile via OGR.</p>
<p>As usual, we start by registering all the drivers, and then fetch the Shapefile driver as we will need it to create our output file.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;
    <a class="code" href="classOGRSFDriver.html">OGRSFDriver</a> *poDriver;

    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    poDriver = <a class="code" href="classOGRSFDriverRegistrar.html#afbd5602672ac5f1882055cc459375f8e" title="Return the driver manager, creating one if none exist.">OGRSFDriverRegistrar::GetRegistrar</a>()-&gt;<a class="code" href="classOGRSFDriverRegistrar.html#ad214c51c2e38d486388f77fb9314143c" title="Fetch the indicated driver.">GetDriverByName</a>(
                pszDriverName );
    <span class="keywordflow">if</span>( poDriver == NULL )
    {
        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );
        exit( 1 );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogr__api_8h.html">ogr_api.h</a>&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;
    OGRSFDriverH hDriver;

    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    hDriver = <a class="code" href="ogr__api_8h.html#ae814db7e2212b9bbb0fd8c361bee11fe" title="Fetch the indicated driver.">OGRGetDriverByName</a>( pszDriverName );
    <span class="keywordflow">if</span>( hDriver == NULL )
    {
        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );
        exit( 1 );
    }
</pre></div><p>Next we create the datasource. The ESRI Shapefile driver allows us to create a directory full of shapefiles, or a single shapefile as a datasource. In this case we will explicitly create a single file by including the extension in the name. Other drivers behave differently. The second argument to the call is a list of option values, but we will just be using defaults in this case. Details of the options supported are also format specific.</p>
<p>In C ++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRDataSource.html">OGRDataSource</a> *poDS;

    poDS = poDriver-&gt;<a class="code" href="classOGRSFDriver.html#a4339101b2d0851e788b6bcfd248780f6" title="This method attempts to create a new data source based on the passed driver.">CreateDataSource</a>( <span class="stringliteral">&quot;point_out.shp&quot;</span>, NULL );
    <span class="keywordflow">if</span>( poDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRDataSourceH hDS;

    hDS = <a class="code" href="ogr__api_8h.html#ac2b628f8ddc674f72c798829c738bbdd" title="This function attempts to create a new data source based on the passed driver.">OGR_Dr_CreateDataSource</a>( hDriver, <span class="stringliteral">&quot;point_out.shp&quot;</span>, NULL );
    <span class="keywordflow">if</span>( hDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>Now we create the output layer. In this case since the datasource is a single file, we can only have one layer. We pass wkbPoint to specify the type of geometry supported by this layer. In this case we aren't passing any coordinate system information or other special layer creation options.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRLayer.html">OGRLayer</a> *poLayer;

    poLayer = poDS-&gt;<a class="code" href="classOGRDataSource.html#a39cfc6e0ee790506d7638b0dce03c7da" title="This method attempts to create a new layer on the data source with the indicated name, coordinate system, geometry type.">CreateLayer</a>( <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );
    <span class="keywordflow">if</span>( poLayer == NULL )
    {
        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRLayerH hLayer;

    hLayer = <a class="code" href="ogr__api_8h.html#a424d383a37fbeaea58acaea11717f320" title="This function attempts to create a new layer on the data source with the indicated name...">OGR_DS_CreateLayer</a>( hDS, <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );
    <span class="keywordflow">if</span>( hLayer == NULL )
    {
        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>Now that the layer exists, we need to create any attribute fields that should appear on the layer. Fields must be added to the layer before any features are written. To create a field we initialize an <a class="el" href="unionOGRField.html">OGRField</a> object with the information about the field. In the case of Shapefiles, the field width and precision is significant in the creation of the output .dbf file, so we set it specifically, though generally the defaults are OK. For this example we will just have one attribute, a name string associated with the x,y point.</p>
<p>Note that the template <a class="el" href="unionOGRField.html">OGRField</a> we pass to CreateField() is copied internally. We retain ownership of the object.</p>
<p>In C++: </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> oField( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );

    oField.SetWidth(32);

    <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a00b1376a1eabb1298ef278f92f6d84be" title="Create a new field on a layer.">CreateField</a>( &amp;oField ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>In C: </p>
<div class="fragment"><pre class="fragment">    OGRFieldDefnH hFieldDefn;
 
    hFieldDefn = <a class="code" href="ogr__api_8h.html#a24af159359797a83c354fdf6cced3265" title="Create a new field definition.">OGR_Fld_Create</a>( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );

    <a class="code" href="ogr__api_8h.html#a1d7bf7c14a299448efac58f7bf364326" title="Set the formatting width for this field in characters.">OGR_Fld_SetWidth</a>( hFieldDefn, 32);

    <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#aab585ef1166c61c4819f7fd46ee4a275" title="Create a new field on a layer.">OGR_L_CreateField</a>( hLayer, hFieldDefn, TRUE ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );
        exit( 1 );
    }

    <a class="code" href="ogr__api_8h.html#a455fa4a2c2451b1748facb6b7126a822" title="Destroy a field definition.">OGR_Fld_Destroy</a>(hFieldDefn);
</pre></div><p>The following snipping loops reading lines of the form "x,y,name" from stdin, and parsing them.</p>
<p>In C++ and in C : </p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">double</span> x, y;
    <span class="keywordtype">char</span> szName[33];

    <span class="keywordflow">while</span>( !feof(stdin) 
           &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )
    {
</pre></div><p>To write a feature to disk, we must create a local <a class="el" href="classOGRFeature.html">OGRFeature</a>, set attributes and attach geometry before trying to write it to the layer. It is imperative that this feature be instantiated from the <a class="el" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> associated with the layer it will be written to.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;

        poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15" title="Feature factory.">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf" title="Fetch the schema information for this layer.">GetLayerDefn</a>() );
        poFeature-&gt;<a class="code" href="classOGRFeature.html#a4abbe118cc2f3e48bbac7f710b71b531" title="Set field to integer value.">SetField</a>( <span class="stringliteral">&quot;Name&quot;</span>, szName );
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        OGRFeatureH hFeature;

        hFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac" title="Feature factory.">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d" title="Fetch the schema information for this layer.">OGR_L_GetLayerDefn</a>( hLayer ) );
        <a class="code" href="ogr__api_8h.html#ad1a3e8b4a08f9558807389bcdde85bab" title="Set field to string value.">OGR_F_SetFieldString</a>( hFeature, <a class="code" href="ogr__api_8h.html#a9a8a6b93ab97204b94f5c2b358f8f98e" title="Fetch the field index given field name.">OGR_F_GetFieldIndex</a>(hFeature, <span class="stringliteral">&quot;Name&quot;</span>), szName );
</pre></div><p>We create a local geometry object, and assign its copy (indirectly) to the feature. The <a class="el" href="classOGRFeature.html#a40a4ddb33f09a5f340b9139be72e277d" title="Set feature geometry.">OGRFeature::SetGeometryDirectly()</a> differs from <a class="el" href="classOGRFeature.html#af1181ade837a52129ea25b46dd50cf30" title="Set feature geometry.">OGRFeature::SetGeometry()</a> in that the direct method gives ownership of the geometry to the feature. This is generally more efficient as it avoids an extra deep object copy of the geometry.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRPoint.html">OGRPoint</a> pt;
        pt.<a class="code" href="classOGRPoint.html#a0eef5e2d9e0edeca0e0f06c7527facb4" title="Assign point X coordinate.">setX</a>( x );
        pt.<a class="code" href="classOGRPoint.html#ab064eaaedb2140ed1410e7c2ce4ad1ca" title="Assign point Y coordinate.">setY</a>( y );
        
        poFeature-&gt;<a class="code" href="classOGRFeature.html#af1181ade837a52129ea25b46dd50cf30" title="Set feature geometry.">SetGeometry</a>( &amp;pt ); 
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        OGRGeometryH hPt;
        hPt = <a class="code" href="ogr__api_8h.html#a4e47710cf70e5bc72216704ddfead0dd" title="Create an empty geometry of desired type.">OGR_G_CreateGeometry</a>(<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>);
        OGR_G_SetPoint_2D(hPt, 0, x, y);
        
        <a class="code" href="ogr__api_8h.html#a7b9c524f5c01a6a4b4e50e351d03299f" title="Set feature geometry.">OGR_F_SetGeometry</a>( hFeature, hPt ); 
        <a class="code" href="ogr__api_8h.html#ac4e665f5f9690c4fa0c190b930fe9492" title="Destroy geometry object.">OGR_G_DestroyGeometry</a>(hPt);
</pre></div><p>Now we create a feature in the file. The <a class="el" href="classOGRLayer.html#aaa1e32016f481596a55e1d988a15a067" title="Create and write a new feature within a layer.">OGRLayer::CreateFeature()</a> does not take ownership of our feature so we clean it up when done with it.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#aaa1e32016f481596a55e1d988a15a067" title="Create and write a new feature within a layer.">CreateFeature</a>( poFeature ) != OGRERR_NONE )
        {
           printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );
           exit( 1 );
        }
        
        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45" title="Destroy feature.">OGRFeature::DestroyFeature</a>( poFeature );
   }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a301d319111285a47fe6cda6e079214f8" title="Create and write a new feature within a layer.">OGR_L_CreateFeature</a>( hLayer, hFeature ) != OGRERR_NONE )
        {
           printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );
           exit( 1 );
        }
        
        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb" title="Destroy feature.">OGR_F_Destroy</a>( hFeature );
   }
</pre></div><p>Finally we need to close down the datasource in order to ensure headers are written out in an orderly way and all resources are recovered.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRDataSource.html#a77841576d07b24a01208e4125ccb40a5" title="Closes opened datasource and releases allocated resources.">OGRDataSource::DestroyDataSource</a>( poDS );
}
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="ogr__api_8h.html#a4823e7c3513cd9d57254364de9a1d021" title="Closes opened datasource and releases allocated resources.">OGR_DS_Destroy</a>( hDS );
}
</pre></div><p>The same program all in one block looks like this:</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogrsf__frmts_8h.html">ogrsf_frmts.h</a>&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;
    <a class="code" href="classOGRSFDriver.html">OGRSFDriver</a> *poDriver;

    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    poDriver = <a class="code" href="classOGRSFDriverRegistrar.html#afbd5602672ac5f1882055cc459375f8e" title="Return the driver manager, creating one if none exist.">OGRSFDriverRegistrar::GetRegistrar</a>()-&gt;<a class="code" href="classOGRSFDriverRegistrar.html#ad214c51c2e38d486388f77fb9314143c" title="Fetch the indicated driver.">GetDriverByName</a>(
                pszDriverName );
    <span class="keywordflow">if</span>( poDriver == NULL )
    {
        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );
        exit( 1 );
    }

    <a class="code" href="classOGRDataSource.html">OGRDataSource</a> *poDS;

    poDS = poDriver-&gt;<a class="code" href="classOGRSFDriver.html#a4339101b2d0851e788b6bcfd248780f6" title="This method attempts to create a new data source based on the passed driver.">CreateDataSource</a>( <span class="stringliteral">&quot;point_out.shp&quot;</span>, NULL );
    <span class="keywordflow">if</span>( poDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );
        exit( 1 );
    }

    <a class="code" href="classOGRLayer.html">OGRLayer</a> *poLayer;

    poLayer = poDS-&gt;<a class="code" href="classOGRDataSource.html#a39cfc6e0ee790506d7638b0dce03c7da" title="This method attempts to create a new layer on the data source with the indicated name, coordinate system, geometry type.">CreateLayer</a>( <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );
    <span class="keywordflow">if</span>( poLayer == NULL )
    {
        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );
        exit( 1 );
    }

    <a class="code" href="classOGRFieldDefn.html">OGRFieldDefn</a> oField( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );

    oField.SetWidth(32);

    <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a00b1376a1eabb1298ef278f92f6d84be" title="Create a new field on a layer.">CreateField</a>( &amp;oField ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );
        exit( 1 );
    }

    <span class="keywordtype">double</span> x, y;
    <span class="keywordtype">char</span> szName[33];

    <span class="keywordflow">while</span>( !feof(stdin) 
           &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )
    {
        <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;

        poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15" title="Feature factory.">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf" title="Fetch the schema information for this layer.">GetLayerDefn</a>() );
        poFeature-&gt;<a class="code" href="classOGRFeature.html#a4abbe118cc2f3e48bbac7f710b71b531" title="Set field to integer value.">SetField</a>( <span class="stringliteral">&quot;Name&quot;</span>, szName );

        <a class="code" href="classOGRPoint.html">OGRPoint</a> pt;
        
        pt.<a class="code" href="classOGRPoint.html#a0eef5e2d9e0edeca0e0f06c7527facb4" title="Assign point X coordinate.">setX</a>( x );
        pt.<a class="code" href="classOGRPoint.html#ab064eaaedb2140ed1410e7c2ce4ad1ca" title="Assign point Y coordinate.">setY</a>( y );
 
        poFeature-&gt;<a class="code" href="classOGRFeature.html#af1181ade837a52129ea25b46dd50cf30" title="Set feature geometry.">SetGeometry</a>( &amp;pt ); 

        <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#aaa1e32016f481596a55e1d988a15a067" title="Create and write a new feature within a layer.">CreateFeature</a>( poFeature ) != OGRERR_NONE )
        {
           printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );
           exit( 1 );
        }

         <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45" title="Destroy feature.">OGRFeature::DestroyFeature</a>( poFeature );
    }

    <a class="code" href="classOGRDataSource.html#a77841576d07b24a01208e4125ccb40a5" title="Closes opened datasource and releases allocated resources.">OGRDataSource::DestroyDataSource</a>( poDS );
}
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;<a class="code" href="ogr__api_8h.html">ogr_api.h</a>&quot;</span>

<span class="keywordtype">int</span> main()
{
    <span class="keyword">const</span> <span class="keywordtype">char</span> *pszDriverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>;
    OGRSFDriverH hDriver;
    OGRDataSourceH hDS;
    OGRLayerH hLayer;
    OGRFieldDefnH hFieldDefn;
    <span class="keywordtype">double</span> x, y;
    <span class="keywordtype">char</span> szName[33];

    <a class="code" href="ogr__api_8h.html#ae904632d0bc86ba5501921ca594e18da" title="Register all drivers.">OGRRegisterAll</a>();

    hDriver = <a class="code" href="ogr__api_8h.html#ae814db7e2212b9bbb0fd8c361bee11fe" title="Fetch the indicated driver.">OGRGetDriverByName</a>( pszDriverName );
    <span class="keywordflow">if</span>( hDriver == NULL )
    {
        printf( <span class="stringliteral">&quot;%s driver not available.\n&quot;</span>, pszDriverName );
        exit( 1 );
    }

    hDS = <a class="code" href="ogr__api_8h.html#ac2b628f8ddc674f72c798829c738bbdd" title="This function attempts to create a new data source based on the passed driver.">OGR_Dr_CreateDataSource</a>( hDriver, <span class="stringliteral">&quot;point_out.shp&quot;</span>, NULL );
    <span class="keywordflow">if</span>( hDS == NULL )
    {
        printf( <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span> );
        exit( 1 );
    }

    hLayer = <a class="code" href="ogr__api_8h.html#a424d383a37fbeaea58acaea11717f320" title="This function attempts to create a new layer on the data source with the indicated name...">OGR_DS_CreateLayer</a>( hDS, <span class="stringliteral">&quot;point_out&quot;</span>, NULL, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>, NULL );
    <span class="keywordflow">if</span>( hLayer == NULL )
    {
        printf( <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span> );
        exit( 1 );
    }

    hFieldDefn = <a class="code" href="ogr__api_8h.html#a24af159359797a83c354fdf6cced3265" title="Create a new field definition.">OGR_Fld_Create</a>( <span class="stringliteral">&quot;Name&quot;</span>, <a class="code" href="ogr__core_8h.html#a787194bea637faf12d61643124a7c9fca862a7b8506c67c5390c2e0860c4edf45">OFTString</a> );

    <a class="code" href="ogr__api_8h.html#a1d7bf7c14a299448efac58f7bf364326" title="Set the formatting width for this field in characters.">OGR_Fld_SetWidth</a>( hFieldDefn, 32);

    <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#aab585ef1166c61c4819f7fd46ee4a275" title="Create a new field on a layer.">OGR_L_CreateField</a>( hLayer, hFieldDefn, TRUE ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span> );
        exit( 1 );
    }

    <a class="code" href="ogr__api_8h.html#a455fa4a2c2451b1748facb6b7126a822" title="Destroy a field definition.">OGR_Fld_Destroy</a>(hFieldDefn);

    <span class="keywordflow">while</span>( !feof(stdin) 
           &amp;&amp; fscanf( stdin, <span class="stringliteral">&quot;%lf,%lf,%32s&quot;</span>, &amp;x, &amp;y, szName ) == 3 )
    {
        OGRFeatureH hFeature;
        OGRGeometryH hPt;

        hFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac" title="Feature factory.">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d" title="Fetch the schema information for this layer.">OGR_L_GetLayerDefn</a>( hLayer ) );
        <a class="code" href="ogr__api_8h.html#ad1a3e8b4a08f9558807389bcdde85bab" title="Set field to string value.">OGR_F_SetFieldString</a>( hFeature, <a class="code" href="ogr__api_8h.html#a9a8a6b93ab97204b94f5c2b358f8f98e" title="Fetch the field index given field name.">OGR_F_GetFieldIndex</a>(hFeature, <span class="stringliteral">&quot;Name&quot;</span>), szName );

        hPt = <a class="code" href="ogr__api_8h.html#a4e47710cf70e5bc72216704ddfead0dd" title="Create an empty geometry of desired type.">OGR_G_CreateGeometry</a>(<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>);
        OGR_G_SetPoint_2D(hPt, 0, x, y);

        <a class="code" href="ogr__api_8h.html#a7b9c524f5c01a6a4b4e50e351d03299f" title="Set feature geometry.">OGR_F_SetGeometry</a>( hFeature, hPt ); 
        <a class="code" href="ogr__api_8h.html#ac4e665f5f9690c4fa0c190b930fe9492" title="Destroy geometry object.">OGR_G_DestroyGeometry</a>(hPt);

        <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a301d319111285a47fe6cda6e079214f8" title="Create and write a new feature within a layer.">OGR_L_CreateFeature</a>( hLayer, hFeature ) != OGRERR_NONE )
        {
           printf( <span class="stringliteral">&quot;Failed to create feature in shapefile.\n&quot;</span> );
           exit( 1 );
        }

        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb" title="Destroy feature.">OGR_F_Destroy</a>( hFeature );
   }

   <a class="code" href="ogr__api_8h.html#a4823e7c3513cd9d57254364de9a1d021" title="Closes opened datasource and releases allocated resources.">OGR_DS_Destroy</a>( hDS );
}
</pre></div><p>In Python : </p>
<div class="fragment"><pre class="fragment"><span class="keyword">import</span> sys
<span class="keyword">import</span> ogr
<span class="keyword">import</span> <span class="keywordtype">string</span>

driverName = <span class="stringliteral">&quot;ESRI Shapefile&quot;</span>
drv = ogr.GetDriverByName( driverName )
<span class="keywordflow">if</span> drv is None:
    print <span class="stringliteral">&quot;%s driver not available.\n&quot;</span> % driverName
    sys.exit( 1 )

ds = drv.CreateDataSource( <span class="stringliteral">&quot;point_out.shp&quot;</span> )
<span class="keywordflow">if</span> ds is None:
    print <span class="stringliteral">&quot;Creation of output file failed.\n&quot;</span>
    sys.exit( 1 )

lyr = ds.CreateLayer( <span class="stringliteral">&quot;point_out&quot;</span>, None, ogr.wkbPoint )
<span class="keywordflow">if</span> lyr is None:
    print <span class="stringliteral">&quot;Layer creation failed.\n&quot;</span>
    sys.exit( 1 )

field_defn = ogr.FieldDefn( <span class="stringliteral">&quot;Name&quot;</span>, ogr.OFTString )
field_defn.SetWidth( 32 )

<span class="keywordflow">if</span> lyr.CreateField ( field_defn ) != 0:
    print <span class="stringliteral">&quot;Creating Name field failed.\n&quot;</span>
    sys.exit( 1 )

<span class="preprocessor"># Expected format of user input: x y name</span>
<span class="preprocessor"></span>linestring = raw_input()
linelist = <span class="keywordtype">string</span>.split(linestring)

while len(linelist) == 3:
    x = <span class="keywordtype">float</span>(linelist[0])
    y = <span class="keywordtype">float</span>(linelist[1])
    name = linelist[2]

    feat = ogr.Feature( lyr.GetLayerDefn())
    feat.SetField( &quot;Name&quot;, name )

    pt = ogr.Geometry(ogr.<a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a>)
    pt.SetPoint_2D(0, x, y)

    feat.SetGeometry(pt)

    if lyr.CreateFeature(feat) != 0:
        print &quot;Failed to create feature in shapefile.\n&quot;
        sys.exit( 1 )

    feat.Destroy()

    linestring = raw_input()
    linelist = <span class="keywordtype">string</span>.split(linestring)

ds = None
</pre></div><p>Starting with OGR 1.11, <a href="http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields">several geometry fields</a> can be associated to a feature. This capability is just available for a few file formats, such as PostGIS.</p>
<p>To create such datasources, geometry fields must be first created. Spatial reference system objects can be associated to each geometry field.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classOGRGeomFieldDefn.html">OGRGeomFieldDefn</a> oPointField( <span class="stringliteral">&quot;PointField&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );
    <a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>* poSRS = <span class="keyword">new</span> <a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>();
    poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#a8a5b8c9a205eedc6b88a14aa0c219969" title="Initialize SRS based on EPSG GCS or PCS code.">importFromEPSG</a>(4326);
    oPointField.SetSpatialRef(poSRS);
    poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#aef9a8378c266604b9cd09042597a649f" title="Decrements the reference count by one, and destroy if zero.">Release</a>();
    
    <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#af3c68cad279ad80a476c6fb307cf5e48" title="Create a new geometry field on a layer.">CreateGeomField</a>( &amp;oPointField ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating field PointField failed.\n&quot;</span> );
        exit( 1 );
    }
    
    <a class="code" href="classOGRGeomFieldDefn.html">OGRGeomFieldDefn</a> oFieldPoint2( <span class="stringliteral">&quot;PointField2&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );
    poSRS = <span class="keyword">new</span> <a class="code" href="classOGRSpatialReference.html">OGRSpatialReference</a>();
    poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#a8a5b8c9a205eedc6b88a14aa0c219969" title="Initialize SRS based on EPSG GCS or PCS code.">importFromEPSG</a>(32631);
    oPointField2.SetSpatialRef(poSRS);
    poSRS-&gt;<a class="code" href="classOGRSpatialReference.html#aef9a8378c266604b9cd09042597a649f" title="Decrements the reference count by one, and destroy if zero.">Release</a>();
    
    <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#af3c68cad279ad80a476c6fb307cf5e48" title="Create a new geometry field on a layer.">CreateGeomField</a>( &amp;oPointField2 ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating field PointField2 failed.\n&quot;</span> );
        exit( 1 );
    }
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">    OGRGeomFieldDefnH hPointField;
    OGRGeomFieldDefnH hPointField2;
    OGRSpatialReferenceH hSRS;

    hPointField = <a class="code" href="ogr__api_8h.html#a4681750642cae49933ba4fc962744b78" title="Create a new field geometry definition.">OGR_GFld_Create</a>( <span class="stringliteral">&quot;PointField&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );
    hSRS = <a class="code" href="ogr__srs__api_8h.html#a6bfe88d5f18f2a8705f9e7a9586b795e" title="Constructor.">OSRNewSpatialReference</a>( NULL );
    OSRImportFromEPSG(hSRS, 4326);
    <a class="code" href="ogr__api_8h.html#aa717acc8f4f5f33825334fe72edc2be9" title="Set the spatial reference of this field.">OGR_GFld_SetSpatialRef</a>(hPointField, hSRS);
    <a class="code" href="ogr__srs__api_8h.html#adb5e564701dab4e83b3d353745f4a054" title="Decrements the reference count by one, and destroy if zero.">OSRRelease</a>(hSRS);
    
    <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#af6908931c4f3ad364fef8d6e831363bc" title="Create a new geometry field on a layer.">OGR_L_CreateGeomField</a>( hLayer, hPointField ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating field PointField failed.\n&quot;</span> );
        exit( 1 );
    }
    
    <a class="code" href="ogr__api_8h.html#a0f3e65993ea2b8b907e43ffa8b106871" title="Destroy a geometry field definition.">OGR_GFld_Destroy</a>( hPointField );

    hPointField2 = <a class="code" href="ogr__api_8h.html#a4681750642cae49933ba4fc962744b78" title="Create a new field geometry definition.">OGR_GFld_Create</a>( <span class="stringliteral">&quot;PointField2&quot;</span>, <a class="code" href="ogr__core_8h.html#a800236a0d460ef66e687b7b65610f12aa6f8377c5a4a9d36ae2384f4a5f45d77f">wkbPoint</a> );
    OSRImportFromEPSG(hSRS, 32631);
    <a class="code" href="ogr__api_8h.html#aa717acc8f4f5f33825334fe72edc2be9" title="Set the spatial reference of this field.">OGR_GFld_SetSpatialRef</a>(hPointField2, hSRS);
    <a class="code" href="ogr__srs__api_8h.html#adb5e564701dab4e83b3d353745f4a054" title="Decrements the reference count by one, and destroy if zero.">OSRRelease</a>(hSRS);
    
    <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#af6908931c4f3ad364fef8d6e831363bc" title="Create a new geometry field on a layer.">OGR_L_CreateGeomField</a>( hLayer, hPointField2 ) != OGRERR_NONE )
    {
        printf( <span class="stringliteral">&quot;Creating field PointField2 failed.\n&quot;</span> );
        exit( 1 );
    }
    
    <a class="code" href="ogr__api_8h.html#a0f3e65993ea2b8b907e43ffa8b106871" title="Destroy a geometry field definition.">OGR_GFld_Destroy</a>( hPointField2 );
</pre></div><p>To write a feature to disk, we must create a local <a class="el" href="classOGRFeature.html">OGRFeature</a>, set attributes and attach geometries before trying to write it to the layer. It is imperative that this feature be instantiated from the <a class="el" href="classOGRFeatureDefn.html">OGRFeatureDefn</a> associated with the layer it will be written to.</p>
<p>In C++ : </p>
<div class="fragment"><pre class="fragment">        <a class="code" href="classOGRFeature.html">OGRFeature</a> *poFeature;
        <a class="code" href="classOGRGeometry.html">OGRGeometry</a> *poGeometry;
        <span class="keywordtype">char</span>* pszWKT;

        poFeature = <a class="code" href="classOGRFeature.html#a0ef4455f24cfbec6cf37110f9116cf15" title="Feature factory.">OGRFeature::CreateFeature</a>( poLayer-&gt;<a class="code" href="classOGRLayer.html#a80473bcfd11341e70dd35bebe94026cf" title="Fetch the schema information for this layer.">GetLayerDefn</a>() );
        
        pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (2 49)&quot;</span>;
        <a class="code" href="classOGRGeometryFactory.html#a9418f71bcfb1e334173882c38d89d070" title="Create a geometry object of the appropriate type from it&amp;#39;s well known text representation.">OGRGeometryFactory::createFromWkt</a>( &amp;pszWKT, NULL, &amp;poGeometry );
        poFeature-&gt;<a class="code" href="classOGRFeature.html#ae0ddbbc910727ada3b2cd00a357222da" title="Set feature geometry of a specified geometry field.">SetGeomFieldDirectly</a>( <span class="stringliteral">&quot;PointField&quot;</span>, poGeometry );
        
        pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span>;
        <a class="code" href="classOGRGeometryFactory.html#a9418f71bcfb1e334173882c38d89d070" title="Create a geometry object of the appropriate type from it&amp;#39;s well known text representation.">OGRGeometryFactory::createFromWkt</a>( &amp;pszWKT, NULL, &amp;poGeometry );
        poFeature-&gt;<a class="code" href="classOGRFeature.html#ae0ddbbc910727ada3b2cd00a357222da" title="Set feature geometry of a specified geometry field.">SetGeomFieldDirectly</a>( <span class="stringliteral">&quot;PointField2&quot;</span>, poGeometry );
        
        <span class="keywordflow">if</span>( poLayer-&gt;<a class="code" href="classOGRLayer.html#aaa1e32016f481596a55e1d988a15a067" title="Create and write a new feature within a layer.">CreateFeature</a>( poFeature ) != OGRERR_NONE )
        {
            printf( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );
            exit( 1 );
        }

        <a class="code" href="classOGRFeature.html#a5d2602d11f21567119da0ca6b6c5ad45" title="Destroy feature.">OGRFeature::DestroyFeature</a>( poFeature );
</pre></div><p>In C : </p>
<div class="fragment"><pre class="fragment">        OGRFeatureH hFeature;
        OGRGeometryH hGeometry;
        <span class="keywordtype">char</span>* pszWKT;

        poFeature = <a class="code" href="ogr__api_8h.html#a335fbf2220d7f93437621cae723558ac" title="Feature factory.">OGR_F_Create</a>( <a class="code" href="ogr__api_8h.html#a7b67ea4ab5892c6720460dc7f66eca2d" title="Fetch the schema information for this layer.">OGR_L_GetLayerDefn</a>(hLayer) );
        
        pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (2 49)&quot;</span>;
        <a class="code" href="ogr__api_8h.html#ac02c3ed5f7ebd5039dc2ae70154fd94a" title="Create a geometry object of the appropriate type from it&amp;#39;s well known text representation.">OGR_G_CreateFromWkt</a>( &amp;pszWKT, NULL, &amp;hGeometry );
        <a class="code" href="ogr__api_8h.html#a01530e163973979cfd8248e3ecbf2640" title="Set feature geometry of a specified geometry field.">OGR_F_SetGeomFieldDirectly</a>( hFeature,
            <a class="code" href="ogr__api_8h.html#a546acd0aad47128b1f178a8d01765e63" title="Fetch the geometry field index given geometry field name.">OGR_F_GetGeomFieldIndex</a>(hFeature, <span class="stringliteral">&quot;PointField&quot;</span>), hGeometry );
        
        pszWKT = (<span class="keywordtype">char</span>*) <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span>;
        <a class="code" href="ogr__api_8h.html#ac02c3ed5f7ebd5039dc2ae70154fd94a" title="Create a geometry object of the appropriate type from it&amp;#39;s well known text representation.">OGR_G_CreateFromWkt</a>( &amp;pszWKT, NULL, &amp;hGeometry );
        <a class="code" href="ogr__api_8h.html#a01530e163973979cfd8248e3ecbf2640" title="Set feature geometry of a specified geometry field.">OGR_F_SetGeomFieldDirectly</a>( hFeature,
            <a class="code" href="ogr__api_8h.html#a546acd0aad47128b1f178a8d01765e63" title="Fetch the geometry field index given geometry field name.">OGR_F_GetGeomFieldIndex</a>(hFeature, <span class="stringliteral">&quot;PointField2&quot;</span>), hGeometry );
        
        <span class="keywordflow">if</span>( <a class="code" href="ogr__api_8h.html#a301d319111285a47fe6cda6e079214f8" title="Create and write a new feature within a layer.">OGR_L_CreateFeature</a>( hFeature ) != OGRERR_NONE )
        {
            printf( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );
            exit( 1 );
        }

        <a class="code" href="ogr__api_8h.html#a16fb8126aa932f4b4acdaca5ea99bbbb" title="Destroy feature.">OGR_F_Destroy</a>( hFeature );
</pre></div><p>In Python : </p>
<div class="fragment"><pre class="fragment">        feat = ogr.Feature( lyr.GetLayerDefn() )
        
        feat.SetGeomFieldDirectly( <span class="stringliteral">&quot;PointField&quot;</span>,
            ogr.CreateGeometryFromWkt( <span class="stringliteral">&quot;POINT (2 49)&quot;</span> ) )
        feat.SetGeomFieldDirectly( <span class="stringliteral">&quot;PointField2&quot;</span>,
            ogr.CreateGeometryFromWkt( <span class="stringliteral">&quot;POINT (500000 4500000)&quot;</span> ) )

        <span class="keywordflow">if</span> lyr.CreateFeature( feat ) != 0 )
        {
            print( <span class="stringliteral">&quot;Failed to create feature.\n&quot;</span> );
            sys.exit( 1 );
        }
</pre></div> </div>
<hr>

Generated for GDAL by 
<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.7.1.
</body>
</html>
